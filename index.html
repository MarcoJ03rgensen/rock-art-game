<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lascaux Cave Art: Solutrean-Badegoulian Transition (17,190 ± 140 BP)</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="game-container">
        <!-- Progress Bar -->
        <div class="progress-bar" id="progressBar" style="display: none;">
            <div class="progress-fill" id="progressFill"></div>
            <div class="progress-text" id="progressText">Stage 1/5</div>
        </div>

        <!-- Title Screen -->
        <div class="screen" id="titleScreen">
            <h1 class="title">Lascaux Cave Art: Scientific Reconstruction</h1>
            <h2 class="subtitle">Upper Solutrean–Badegoulian/Early Magdalenian Transition</h2>
            <h3 class="dating">17,190 ± 140 years BP (Before Present)</h3>
            <div class="intro-text">
                <p><strong>Radiocarbon Dating:</strong> Charcoal from Passageway: 17,190 ± 140 BP (André Glory excavations). This places Lascaux at the boundary between Upper Solutrean and early Badegoulian/Magdalenian cultural phases.</p>
                <p>This interactive reconstruction is based on micro-XANES spectroscopy, TEM analysis, and experimental archaeology (Chalmin et al. 2006, Lorblanchet 1990, Genty et al. 2011).</p>
                <p><strong>Scientific Methods:</strong> X-ray Absorption Near-Edge Structure (XANES), Transmission Electron Microscopy (TEM), AMS radiocarbon dating, uranium-series dating.</p>
            </div>
            <button class="btn btn-primary" onclick="game.startGame()">Start Your Journey</button>
            <div class="info-badge">
                <span class="info-icon">ℹ</span>
                <span class="info-text">Archaeologically verified • Peer-reviewed research • Academic accuracy</span>
            </div>
        </div>

        <!-- Stage 1: Geographic Sourcing of Specific Minerals -->
        <div class="screen" id="stage1" style="display: none;">
            <h2>Stage 1: Geographic Sourcing of Minerals</h2>
            <p class="stage-instruction">Micro-XANES analysis identified specific manganese oxide minerals in Lascaux paintings with NO local sources. Click regions to understand the geographic challenge.</p>
            <div class="scientific-note">
                <p><strong>Critical Finding:</strong> Manganese oxides detected at Lascaux (romanechite, hausmannite, todorokite, cryptomelane) have no deposits in the Dordogne region. Nearest sources: Central Pyrénées (Vieille-Aure, Labiat), ~250 kilometers away. This indicates long-distance travel or trade networks during the Solutrean-Badegoulian transition.</p>
                <p><strong>Source:</strong> Chalmin, E., Menu, M., &amp; Farges, F. (2006). Stanford/ESRF micro-XANES study.</p>
            </div>
            
            <div class="landscape-container">
                <svg class="landscape" viewBox="0 0 800 400" id="landscape">
                    <!-- Sky -->
                    <rect x="0" y="0" width="800" height="200" fill="#87CEEB" opacity="0.3"/>
                    
                    <!-- Central Pyrénées (manganese minerals - 250km away) -->
                    <path d="M 0 200 L 150 180 L 200 150 L 250 170 L 280 200 L 280 400 L 0 400 Z" 
                          fill="#4A4A4A" class="clickable-area" data-material="romanechite" id="area-romanechite"/>
                    <text x="90" y="240" class="area-label" style="font-size: 12px;">Central Pyrénées</text>
                    <text x="95" y="255" class="area-label" style="font-size: 11px;">(250 km away)</text>
                    
                    <!-- Pyrénées hausmannite -->
                    <path d="M 280 200 L 350 190 L 450 195 L 500 200 L 500 400 L 280 400 Z" 
                          fill="#3A3A3A" class="clickable-area" data-material="hausmannite" id="area-hausmannite"/>
                    <text x="330" y="300" class="area-label" style="font-size: 12px;">Hautes-Pyrénées</text>
                    <text x="345" y="315" class="area-label" style="font-size: 11px;">(Hausmannite)</text>
                    
                    <!-- Local Dordogne hematite -->
                    <path d="M 500 200 L 580 195 L 650 200 L 680 210 L 680 400 L 500 400 Z" 
                          fill="#8B4513" class="clickable-area" data-material="hematite" id="area-hematite"/>
                    <text x="545" y="300" class="area-label" style="font-size: 12px;">Local Dordogne</text>
                    <text x="560" y="315" class="area-label" style="font-size: 11px;">(Hematite)</text>
                    
                    <!-- Local goethite -->
                    <path d="M 680 210 L 730 200 L 780 190 L 800 195 L 800 400 L 680 400 Z" 
                          fill="#B8860B" class="clickable-area" data-material="goethite" id="area-goethite"/>
                    <text x="700" y="295" class="area-label" style="font-size: 12px;">Dordogne</text>
                    <text x="705" y="310" class="area-label" style="font-size: 11px;">(Goethite)</text>
                    
                    <!-- Distance markers -->
                    <text x="140" y="370" class="distance-marker" style="font-size: 11px; fill: rgba(255,255,255,0.8); font-style: italic;">250 km →</text>
                    <text x="580" y="370" class="distance-marker" style="font-size: 11px; fill: rgba(255,255,255,0.8); font-style: italic;">← Local (25-40 km)</text>
                    
                    <!-- Ground line -->
                    <path d="M 0 200 L 150 180 L 200 150 L 250 170 L 280 200 L 350 190 L 450 195 L 500 200 L 580 195 L 650 200 L 680 210 L 730 200 L 780 190 L 800 195" 
                          stroke="#5C4033" stroke-width="2" fill="none"/>
                </svg>
            </div>

            <div class="distance-info">
                <h3>Geographic Analysis:</h3>
                <p><strong>Critical Finding:</strong> Manganese oxide minerals (romanechite, hausmannite, todorokite, cryptomelane) have <strong>NO local deposits</strong> in Dordogne region.</p>
                <p><strong>Nearest sources:</strong> Central Pyrénées (Vieille-Aure/Labiat) — <span class="distance-highlight">~250 kilometers away</span></p>
                <p><strong>Implications:</strong> Long-distance travel or established trade networks during Solutrean-Badegoulian transition (17,190 ± 140 BP).</p>
                <p><strong>Iron oxides:</strong> Local Dordogne sources (25-40 km radius).</p>
            </div>
            
            <div class="collected-items">
                <h3>Collected Minerals:</h3>
                <div id="collectedList" class="item-list"></div>
            </div>

            <button class="btn btn-secondary" id="stage1Next" onclick="game.nextStage()" disabled>Continue to Mineral Preparation (collect at least 3)</button>
        </div>

        <!-- Stage 2: Mineralogical Preparation & Deliberate Mixtures -->
        <div class="screen" id="stage2" style="display: none;">
            <h2>Stage 2: Mineralogical Preparation</h2>
            <p class="stage-instruction">Analysis reveals DELIBERATE MIXTURES of specific minerals. Grind minerals using stone tools (shoulder blades as mortars). Create technique-specific preparations.</p>
            <div class="scientific-note">
                <p><strong>Great Bull Analysis (Chalmin et al. 2006):</strong></p>
                <p><strong>Chignon (between ears):</strong> Romanechite (Ba₂Mn₅O₁₀·nH₂O) + quartz + clay + iron oxide — Applied by BRUSH</p>
                <p><strong>Muffle (snout):</strong> Hausmannite (Mn₃O₄) + calcite + Fe-rich clays — Applied by BLOW/SPRAY technique</p>
                <p><strong>Significance:</strong> Different mineral preparations matched to different application methods. Hausmannite formation requires &gt;1000°C or specific chemical processes—never before found in prehistoric pigments.</p>
            </div>
            
            <div class="preparation-area">
                <div class="work-station">
                    <h3>Raw Materials</h3>
                    <div id="rawMaterials" class="material-slots"></div>
                </div>

                <div class="work-station">
                    <h3>Grinding Stone</h3>
                    <div class="mortar" id="mortar">
                        <div class="mortar-content" id="mortarContent">
                            <p class="hint">Drag a material here, then click and hold to grind</p>
                        </div>
                    </div>
                    <div class="grind-progress" id="grindProgress"></div>
                </div>

                <div class="work-station">
                    <h3>Prepared Paints</h3>
                    <div id="preparedPaints" class="paint-pots"></div>
                </div>
            </div>

            <div class="binder-selection">
                <h3>Select Binder (Archaeologically Documented):</h3>
                <select id="binderSelect">
                    <option value="fat">Animal Fat (reindeer, horse, bison)</option>
                    <option value="marrow">Bone Marrow</option>
                    <option value="water">Cave Water (Ca-rich)</option>
                </select>
                <p class="binder-note"><strong>Note:</strong> NO biotite/feldspar extenders at Lascaux (17,190 BP). Those appear later at Niaux (12,000-14,000 BP, Magdalenian period). Lascaux predates those recipes.</p>
            </div>

            <button class="btn btn-secondary" id="stage2Next" onclick="game.nextStage()" disabled>Continue to Cave Surface</button>
        </div>

        <!-- Stage 3: Preparing Cave Surface -->
        <div class="screen" id="stage3" style="display: none;">
            <h2>Stage 3: Calcite Surface Selection</h2>
            <p class="stage-instruction">Select white calcite (CaCO₃) surfaces. Lascaux was completely DRY during occupation—no active stalagmite/stalactite formation.</p>
            <div class="scientific-note">
                <p><strong>Cave Characteristics:</strong> White limestone calcite surfaces. NO calcite formation during painting period. The calcite gours (flowstone) that later protected paintings formed 9,530-6,635 years BP (Genty et al. 2011)—thousands of years AFTER the art.</p>
                <p><strong>Topographic Integration:</strong> Artists deliberately selected wall contours—convexities for shoulders, concavities for bellies—creating three-dimensional effects.</p>
            </div>
            
            <div class="cave-wall-container">
                <svg class="cave-wall" viewBox="0 0 800 500" id="caveWall">
                    <!-- Cave wall texture -->
                    <defs>
                        <filter id="roughTexture">
                            <feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="4" />
                            <feColorMatrix type="saturate" values="0.3"/>
                        </filter>
                    </defs>
                    
                    <!-- Wall background -->
                    <rect x="0" y="0" width="800" height="500" fill="#8B7765"/>
                    
                    <!-- Wall areas with different qualities -->
                    <ellipse cx="200" cy="250" rx="120" ry="140" fill="#9B8B7A" class="wall-area" data-quality="rough" opacity="0.8"/>
                    <ellipse cx="400" cy="250" rx="150" ry="160" fill="#AFA090" class="wall-area selectable-wall" data-quality="smooth" opacity="0.9"/>
                    <ellipse cx="600" cy="250" rx="110" ry="130" fill="#8B7760" class="wall-area" data-quality="rough" opacity="0.8"/>
                    
                    <!-- Texture overlay (non-interactive so underlying wall areas receive clicks) -->
                    <rect x="0" y="0" width="800" height="500" filter="url(#roughTexture)" opacity="0.15" pointer-events="none"/>
                </svg>
            </div>

            <div class="surface-tools">
                <label>
                    <input type="checkbox" id="scrapeWall"> Scrape and clean the surface
                </label>
                <label>
                    <input type="checkbox" id="sketchOutline"> Make preliminary charcoal sketch
                </label>
            </div>

            <button class="btn btn-secondary" id="stage3Next" onclick="game.nextStage()" disabled>Continue to Painting</button>
        </div>

        <!-- Stage 4: Painting -->
        <div class="screen" id="stage4" style="display: none;">
            <h2>Stage 4: Technique-Material Relationships</h2>
            <p class="stage-instruction">Match specific mineral preparations to documented application methods. Each technique requires specific paint formulation.</p>
            <div class="scientific-note">
                <p><strong>Documented Techniques at Lascaux:</strong></p>
                <p><strong>BRUSH APPLICATION:</strong> Romanechite-based paints. Animal hair or plant fiber brushes. Controlled strokes, crisp edges. (Example: Great Bull chignon)</p>
                <p><strong>BLOW/SPRAY:</strong> Hausmannite-based paints. Hollow bird bone tubes. Liquid paint + saliva, blown through tube ("spit-painting"). Sharp edge one side, diffused other. (Lorblanchet 1990 experimental replication)</p>
                <p><strong>Fauna:</strong> Aurochs (dominant), Horses, Red deer, Ibex. <strong>Mystery:</strong> NO reindeer depicted despite being primary food source (abundant bones).</p>
            </div>
            
            <div class="painting-controls">
                <div class="control-group">
                    <label>Application Technique:</label>
                    <select id="techniqueSelect" onchange="game.changeTechnique()">
                        <option value="brush">Brush (romanechite-based)</option>
                        <option value="spray">Blow/Spray (hausmannite-based)</option>
                        <option value="finger">Finger (direct application)</option>
                        <option value="engraving">Engraving (flint tools)</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label>Fauna (Lascaux-specific):</label>
                    <select id="animalSelect" onchange="game.changeAnimal()">
                        <option value="aurochs">Aurochs (dominant species)</option>
                        <option value="horse">Horse (Chinese horses)</option>
                        <option value="deer">Red Deer (cervids)</option>
                        <option value="bison">Bison</option>
                    </select>
                    <p class="fauna-note">Note: Reindeer NOT depicted (despite being primary food source)</p>
                </div>
                
                <div class="control-group">
                    <label>Paint Color:</label>
                    <div id="paintColors" class="color-palette"></div>
                </div>

                <div class="control-group">
                    <label>Brush Size</label>
                    <input id="brushSizeSlider" type="range" min="1" max="60" value="10">
                </div>

                <div class="control-group">
                    <label>Opacity</label>
                    <input id="brushOpacitySlider" type="range" min="0.05" max="1" step="0.05" value="0.6">
                </div>
            </div>

            <div class="canvas-container">
                <!-- Main painting canvas -->
                <canvas id="paintCanvas" width="700" height="500"></canvas>
                <!-- Particle overlay (dust motes) -->
                <canvas id="particleCanvas" width="700" height="500" class="overlay-canvas"></canvas>
                <!-- Dynamic light overlay (follows cursor) -->
                <canvas id="lightCanvas" width="700" height="500" class="overlay-canvas"></canvas>
            </div>

            <div class="canvas-controls">
                <button class="btn btn-secondary" onclick="game.clearCanvas()">Clear Canvas</button>
                <button class="btn btn-secondary" id="undoBtn">Undo</button>
                <button class="btn btn-secondary" id="eraserBtn">Eraser</button>
                <button class="btn btn-secondary" id="exportBtn">Export PNG</button>
                <button class="btn btn-secondary" onclick="game.showTemplate()">Show Template</button>
                <button class="btn btn-secondary" onclick="game.hideTemplate()">Hide Template</button>
            </div>

            <button class="btn btn-secondary" id="stage4Next" onclick="game.nextStage()">Continue to Finishing</button>
        </div>

        <!-- Stage 5: Finishing Details -->
        <div class="screen" id="stage5" style="display: none;">
            <h2>Stage 5: Lamplight Viewing Conditions</h2>
            <p class="stage-instruction">Experience authentic viewing conditions. Art was created and viewed by animal fat lamps (~1500K color temperature).</p>
            <div class="scientific-note">
                <p><strong>Lighting Evidence:</strong> Red sandstone lamp dated to 17,000 BP found at Lascaux (National Prehistory Museum). Fuel: reindeer/horse/bison fat. Wick: juniper twigs.</p>
                <p><strong>Animation Effect:</strong> Flickering lamplight creates illusion of movement—animals appear to run, breathe, shift. This dynamic quality may have been intentional.</p>
                <p><strong>Scaffolding:</strong> Wall holes suggest wooden supports. Some paintings 4+ meters above floor level.</p>
            </div>
            
            <div class="canvas-container">
                <canvas id="finishCanvas" width="700" height="500"></canvas>
            </div>

            <div class="finishing-controls">
                <button class="btn btn-secondary" onclick="game.addDetail('eyes')">Add Eyes</button>
                <button class="btn btn-secondary" onclick="game.addDetail('horns')">Add Horns/Antlers</button>
                <button class="btn btn-secondary" onclick="game.addDetail('shading')">Add Shading</button>
                <label class="lighting-control">
                    <input type="range" id="lightingSlider" min="0" max="100" value="100" oninput="game.adjustLighting(this.value)">
                    <span>Torch Light Effect</span>
                </label>
                <label style="display:flex; align-items:center; gap:8px;">
                    <input type="checkbox" id="ambientToggle"> Ambient Sound
                </label>
            </div>

            <button class="btn btn-primary" onclick="game.completeGame()">Complete Your Masterpiece</button>
        </div>

        <!-- Completion Screen -->
        <div class="screen" id="completionScreen" style="display: none;">
            <h1 class="title">Scientific Reconstruction Complete</h1>
            <h2 class="subtitle">Lascaux Cave Art: 17,190 ± 140 BP</h2>
            <h3 class="dating">Solutrean-Badegoulian Transition Period</h3>
            
            <div class="completion-content">
                <div class="completion-image">
                    <canvas id="finalArtwork" width="600" height="400"></canvas>
                </div>
                
                <div class="completion-summary">
                    <h3>Archaeological Evidence Applied:</h3>
                    <ul>
                        <li>✓ <strong>Micro-XANES (X-ray Absorption Near-Edge Structure):</strong> Stanford/ESRF analysis identified romanechite (Ba₂Mn₅O₁₀·nH₂O), hausmannite (Mn₃O₄), todorokite, cryptomelane in Great Bull painting</li>
                        <li>✓ <strong>TEM (Transmission Electron Microscopy):</strong> Revealed deliberate mineral mixtures: romanechite + quartz + clay + Fe oxide (chignon); hausmannite + calcite + Fe-rich clays (muffle)</li>
                        <li>✓ <strong>AMS Radiocarbon Dating:</strong> 17,190 ± 140 BP from Passageway charcoal (André Glory excavations). Shaft: 16,000 ± 500 BP</li>
                        <li>✓ <strong>Geographic Sourcing:</strong> 250km manganese transport from Central Pyrénées (Vieille-Aure/Labiat) — no local Dordogne deposits</li>
                        <li>✓ <strong>Experimental Archaeology:</strong> Lorblanchet (1990) blow-technique replication using hollow bird bones, proving viability of "spit-painting"</li>
                        <li>✓ <strong>U-Th Dating:</strong> Genty et al. (2011) dated calcite gours formation to 9,530-6,635 BP — 7,000+ years AFTER paintings created</li>
                        <li>✓ <strong>Technique-Material Matching:</strong> Different mineral preparations correlated to different application methods on single animal</li>
                    </ul>
                    
                    <div class="academic-note">
                        <h4>Peer-Reviewed Sources</h4>
                        <p><strong>Chalmin, É., Menu, M., &amp; Farges, F. (2006).</strong> "Analysis of rock art painting and technology of Palaeolithic painters." Stanford Synchrotron Radiation Laboratory &amp; European Synchrotron Radiation Facility micro-XANES study. First identification of hausmannite in prehistoric pigments; documentation of deliberate romanechite/hausmannite mixtures.</p>
                        <p><strong>Genty, D., et al. (2011).</strong> "Uranium-series dating of calcite accretions." Dated flowstone formation to 9,530-6,635 BP, proving paintings preceded protective calcite by millennia.</p>
                        <p><strong>Lorblanchet, M. (1990).</strong> "Experimental replication of Paleolithic painting techniques." Proved hollow bone blow/spray technique feasibility using saliva-mixed pigments.</p>
                        <p><strong>Glory, A. (excavations).</strong> Radiocarbon dating: Passageway 17,190 ± 140 BP; Shaft 16,000 ± 500 BP. Establishes Solutrean-Badegoulian/early Magdalenian cultural attribution.</p>
                        <p><strong>Jézequel, P., et al. (2011).</strong> "Chemical characterization of painting materials." Documented hematite-clay-carbon-carbonate mixtures in red pigments from local Dordogne sources.</p>
                        <p><strong>Breuil, H. &amp; Blanc, A.C. (dated 1998/2002).</strong> Reindeer antler baton: 18,600-18,900 BP (alternative dating suggesting earlier Solutrean-Badegoulian boundary).</p>
                    </div>
                </div>
            </div>

            <div class="final-summary">
                <h4>Key Archaeological Findings from Lascaux:</h4>
                <p><strong>1. Material Procurement:</strong> Manganese oxides transported 250km, demonstrating extensive mobility or trade networks during Upper Paleolithic.</p>
                <p><strong>2. Technological Sophistication:</strong> Different mineral formulations deliberately matched to application techniques (brush vs. blow).</p>
                <p><strong>3. Rare Minerals:</strong> Hausmannite (Mn₃O₄) requires &gt;1000°C formation temperatures—first prehistoric documentation.</p>
                <p><strong>4. Chronological Precision:</strong> Multiple radiocarbon dates consistently place Lascaux at ~17,000 BP, Solutrean–Badegoulian transition.</p>
                <p><strong>5. Preservation Context:</strong> Calcite formation 7,000+ years post-painting preserved art until 1940 discovery.</p>
                <p><strong>6. Viewing Context:</strong> Art created and experienced by flickering animal-fat lamplight in complete darkness, creating animation effects.</p>
            </div>
            
            <button class="btn btn-primary" onclick="game.restartGame()">Create Another Scientific Reconstruction</button>
        </div>

        <!-- Educational Info Modal -->
        <div class="modal" id="infoModal" style="display: none;">
            <div class="modal-content">
                <span class="close-button" onclick="game.closeModal()">&times;</span>
                <h3 id="modalTitle">Information</h3>
                <div id="modalBody"></div>
                <button class="btn btn-primary" onclick="game.closeModal()">Got It!</button>
            </div>
        </div>

        <!-- Transition Screens -->
        <div class="screen transition-screen" id="transitionScreen" style="display: none;">
            <h2 id="transitionTitle"></h2>
            <div id="transitionContent" class="transition-content"></div>
            <button class="btn btn-primary" id="transitionNext" onclick="game.continueFromTransition()">Continue</button>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>